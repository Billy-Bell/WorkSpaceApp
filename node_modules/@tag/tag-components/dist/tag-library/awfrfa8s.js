/*! Built with http://stenciljs.com */
const{h:t}=window.TagLibrary;import{d as e}from"./chunk-3e3cd362.js";import"./chunk-caf2685f.js";import"./chunk-8da4d25d.js";class s{constructor(){this.submitSuccessMessage="The information was successfully saved!",this.submitFailureMessage="Sorry, an unexpected error has occurred",this.submitValidationMessage="Sorry, some of the information is invalid. Please review, adjust and try again",this.serverValidationMapper=e,this.activeStepIndex=0}componentDidLoad(){this.setHeightOnSteps();const t=this.getCurrentStep();t&&(this.deactivateSteps(),this.activateStep(t))}handlePreviousClick(){const t=this.getPreviousStep();t&&(this.deactivateSteps(),this.activateStep(t),this.activeStepIndex--)}handleNextClick(){const t=this.getNextStep();t&&(this.deactivateSteps(),this.activateStep(t),this.activeStepIndex++)}handleFinishClick(){const t=this.getFieldValues();this.submit.emit({body:t})}submitComplete(t){if(400===t.status){const e=this.getFieldValues();let s={};Object.keys(e).forEach(t=>{s[t]=[]}),s=this.serverValidationMapper(t,Object.keys(e)),this.getFields().forEach(t=>{const e=t;e.setErrors(s[e.name])})}this.submitResult={success:t.ok,validationError:400===t.status}}render(){return t("div",null,t("slot",null),this.submitResult&&this.submitResult.success&&t("div",{class:"tag-wizard__alert-container"},t("tag-alert",{type:"information"},this.submitSuccessMessage)),this.submitResult&&!1===this.submitResult.success&&!this.submitResult.validationError&&t("div",{class:"tag-wizard__alert-container"},t("tag-alert",{type:"danger"},this.submitFailureMessage)),this.submitResult&&!1===this.submitResult.success&&this.submitResult.validationError&&t("div",{class:"tag-wizard__alert-container"},t("tag-alert",{type:"danger"},this.submitValidationMessage)))}getFields(){const t=[].slice.call(this.element.querySelectorAll("tag-edit-field"));return[].slice.call(this.element.querySelectorAll("tag-edit-list")).forEach(e=>{const s=[].slice.call(e.shadowRoot.querySelectorAll("tag-edit-field"));t.push.apply(t,s)}),t}getFieldValues(){const t={};return this.getFields().forEach(e=>{const s=e.getAttribute("data-lname"),i=e.getAttribute("data-li");if(s&&i){const a=parseInt(i,10);for(t[s]||(t[s]=[]);t[s].length<=a;)t[s].push({});t[s][a][e.name]=e.value}else t[e.name]=e.value}),t}getPreviousStep(){const t=this.getSteps();let e;const s=this.getCurrentStep();return s&&(s.previousStep?e=this.getStep(s.previousStep):this.activeStepIndex-1>=0&&(e=t[this.activeStepIndex-1])),e}getNextStep(){const t=this.getSteps();let e;const s=this.getCurrentStep();return s&&(s.nextStep?e=this.getStep(s.nextStep):this.activeStepIndex+1<t.length&&(e=t[this.activeStepIndex+1])),e}getSteps(){return[].slice.call(this.element.querySelectorAll("tag-wizard-step"))}getCurrentStep(){const t=this.getSteps();let e;return this.activeStepIndex<t.length&&(e=t[this.activeStepIndex]),e}getStep(t){const e=this.getSteps().filter(e=>e.name.toLowerCase()===t.toLowerCase());return e.length>0?e[0]:void 0}deactivateSteps(){this.getSteps().forEach(t=>{t.style.display="none"})}activateStep(t){t.style.display="block"}setHeightOnSteps(){if(this.height){const t=this.height&&this.height.indexOf("px")===this.height.length-2?parseInt(this.height.substr(0,this.height.length-2),10):void 0,e=t?`${t-60}px`:void 0;this.getSteps().forEach(t=>{const s=t.shadowRoot?t.shadowRoot.querySelector(".tag-wizard-step"):t.querySelector(".tag-wizard-step");s&&(s.style.height=this.height);const i=t.shadowRoot?t.shadowRoot.querySelector(".tag-wizard-step__content-container"):t.querySelector(".tag-wizard-step__content-container");i&&(i.style.maxHeight=e,i.style.height=e)})}}static get is(){return"tag-wizard"}static get encapsulation(){return"shadow"}static get properties(){return{activeStepIndex:{state:!0},element:{elementRef:!0},height:{type:String,attr:"height"},serverValidationMapper:{type:"Any",attr:"server-validation-mapper"},submitComplete:{method:!0},submitFailureMessage:{type:String,attr:"submit-failure-message"},submitResult:{state:!0},submitSuccessMessage:{type:String,attr:"submit-success-message"},submitValidationMessage:{type:String,attr:"submit-validation-message"}}}static get events(){return[{name:"submit",method:"submit",bubbles:!0,cancelable:!0,composed:!0}]}static get listeners(){return[{name:"previousClick",method:"handlePreviousClick"},{name:"nextClick",method:"handleNextClick"},{name:"finishClick",method:"handleFinishClick"}]}static get style(){return":host .tag-wizard__alert-container{margin-top:10px}"}}export{s as TagWizard};